Some of the code might be copied for reference purposes. 
